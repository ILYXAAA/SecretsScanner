<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Logs - Secrets Scanner</title>
    <link rel="stylesheet" href="/secret_scanner/static/css/logs.css">
</head>
<body data-api-logs="{{ get_full_url('api/logs') }}" data-api-microservice-logs="{{ get_full_url('api/microservice-logs') }}">
    <div class="container">
        <div class="header">
            <h1>üìã System Logs</h1>
            <div class="nav-links">
                <a href="{{ get_full_url('dashboard') }}">Dashboard</a>
                <a href="{{ get_full_url('settings') }}">Settings</a>
                {% if current_user == 'admin' %}
                <a href="{{ get_full_url('admin') }}">Admin</a>
                {% endif %}
                <a href="{{ get_full_url('logout') }}">Logout</a>
            </div>
        </div>

        <div class="stats">
            <div class="stat-item">
                Total Lines: <span class="stat-value" id="totalLines">0</span>
            </div>
            <div class="stat-item">
                File Size: <span class="stat-value" id="fileSize">0 KB</span>
            </div>
            <div class="stat-item">
                Last Updated: <span class="stat-value" id="lastUpdated">-</span>
            </div>
            <div class="stat-item">
                Status: <span class="stat-value" id="connectionStatus">Connecting...</span>
            </div>
        </div>

        <div class="date-range-info" id="dateRangeInfo"></div>

        <div class="controls">
            <div class="control-group">
                <label>Auto-refresh:</label>
                <button class="btn active" id="autoRefreshBtn" onclick="toggleAutoRefresh()">ON</button>
            </div>
            
            <div class="control-group">
                <label>Auto-scroll:</label>
                <button class="btn active" id="autoScrollBtn" onclick="toggleAutoScroll()">ON</button>
            </div>
            
            <div class="control-group">
                <label>Log Level:</label>
                <select id="logLevelFilter" onchange="filterLogs()">
                    <option value="">All Levels</option>
                    <option value="DEBUG">DEBUG</option>
                    <option value="INFO">INFO</option>
                    <option value="WARNING">WARNING</option>
                    <option value="ERROR">ERROR</option>
                    <option value="CRITICAL">CRITICAL</option>
                </select>
            </div>
            
            <div class="control-group">
                <label>–ü–æ–∫–∞–∑ —Å—Ç—Ä–æ–∫:</label>
                <select id="linesLimit" onchange="setLinesLimit()">
                    <option value="100">Last 100</option>
                    <option value="500" selected>Last 500</option>
                    <option value="1000">Last 1000</option>
                    <option value="all">All</option>
                </select>
            </div>

            <div class="control-group">
                <label>–ò—Å—Ç–æ—á–Ω–∏–∫:</label>
                <select id="logSourceSelect" onchange="changeLogSource()">
                    <option value="main">Main Service</option>
                    <option value="microservice">Microservice</option>
                </select>
            </div>
            
            <div class="control-group">
                <label>–ü–æ–∏—Å–∫:</label>
                <input type="text" id="searchInput" placeholder="–ü–æ–∏—Å–∫ –≤ –ª–æ–≥–∞—Ö..." onkeyup="searchLogs()">
            </div>
            
            <button class="btn date-picker-btn" onclick="showDatePicker()">üìÖ –í—ã–±—Ä–∞—Ç—å –¥–∞—Ç—ã</button>
            <button class="btn download-btn" onclick="downloadLogs()">üíæ –°–∫–∞—á–∞—Ç—å</button>
            <button class="btn" onclick="refreshLogs()">üîÑ –û–±–Ω–æ–≤–∏—Ç—å</button>
            <button class="btn" onclick="clearDisplay()">üóëÔ∏è –û—á–∏—Å—Ç–∏—Ç—å —ç–∫—Ä–∞–Ω</button>
        </div>

        <div class="log-container">
            <div class="log-header">
                <div class="log-info" id="logInfo">
                    secrets_scanner.log
                </div>
                <div class="log-header-right">
                    <div class="loading" id="loadingIndicator">Loading...</div>
                </div>
            </div>
            <div class="log-content" id="logContent">
                <div style="color: #6b7280; text-align: center; padding: 40px;">
                    Connecting to log stream...
                </div>
            </div>
            <div class="auto-scroll-indicator" id="autoScrollIndicator">
                Auto-scrolling
            </div>
        </div>
    </div>

    <!-- Date Picker Modal -->
    <div class="modal" id="datePickerModal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>–í—ã–±–æ—Ä –¥–∞—Ç</h3>
                <p>–í—ã–±–µ—Ä–∏—Ç–µ –¥–∏–∞–ø–∞–∑–æ–Ω –¥–∞—Ç –¥–ª—è —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏ –ª–æ–≥–æ–≤.</p>
            </div>
            
            <div class="date-inputs">
                <div class="date-input-group">
                    <label for="startDate">–ù–∞—á–∞–ª—å–Ω–∞—è –¥–∞—Ç–∞</label>
                    <input type="date" id="startDate">
                </div>
                
                <div class="date-input-group">
                    <label for="endDate">–ö–æ–Ω–µ—á–Ω–∞—è –¥–∞—Ç–∞</label>
                    <input type="date" id="endDate">
                </div>
            </div>
            
            <div class="modal-actions">
                <button class="btn btn-secondary" onclick="hideDatePicker()">–û—Ç–º–µ–Ω–∞</button>
                <button class="btn btn-danger" onclick="clearDateFilter()">–û—á–∏—Å—Ç–∏—Ç—å</button>
                <button class="btn btn-primary" onclick="applyDateFilter()">–ü—Ä–∏–º–µ–Ω–∏—Ç—å</button>
            </div>
        </div>
    </div>

    <script src="/secret_scanner/static/js/logs.js"></script>
</body>
</html>