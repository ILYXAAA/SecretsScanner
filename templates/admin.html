<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Admin Panel - Secrets Scanner</title>
    <link rel="stylesheet" href="/static/css/admin.css">
</head>
<body>
    <header class="header">
        <a href="/secret_scanner/dashboard" class="logo">
            üîç Secrets Scanner
        </a>
        <nav class="nav-links">
            <a href="/secret_scanner/dashboard">üåê –ì–ª–∞–≤–Ω–∞—è</a>
            <a href="/secret_scanner/multi-scan">üîÑ –ú—É–ª—å—Ç–∏—Å–∫–∞–Ω</a>
            <a href="/secret_scanner/admin">üëë –ê–¥–º–∏–Ω –ø–∞–Ω–µ–ª—å</a>
            <a href="/secret_scanner/settings">‚öôÔ∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∏</a>
            <a href="/secret_scanner/logout">üîö –í—ã–π—Ç–∏</a>
        </nav>
    </header>
    
    <div class="container">
        <div class="admin-header">
            <h1 class="admin-title">
                <span>üëë</span>
                –ê–¥–º–∏–Ω –ø–∞–Ω–µ–ª—å
            </h1>
            <div class="admin-description">
                –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏ –∏ —Å–∏—Å—Ç–µ–º–Ω—ã–º–∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞–º–∏
            </div>
        </div>
        
        {% if request.url.query %}
            {% if 'error=access_denied' in request.url.query %}
            <div class="alert alert-error">–î–æ—Å—Ç—É–ø –∑–∞–ø—Ä–µ—â–µ–Ω. –¢–æ–ª—å–∫–æ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä –º–æ–∂–µ—Ç –ø–æ–ª—É—á–∏—Ç—å –¥–æ—Å—Ç—É–ø –∫ —ç—Ç–æ–π —Å—Ç—Ä–∞–Ω–∏—Ü–µ.</div>
            {% elif 'error=user_exists' in request.url.query %}
            <div class="alert alert-error">–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —Å —Ç–∞–∫–∏–º –∏–º–µ–Ω–µ–º —É–∂–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç.</div>
            {% elif 'error=user_creation_failed' in request.url.query %}
            <div class="alert alert-error">–ù–µ —É–¥–∞–ª–æ—Å—å —Å–æ–∑–¥–∞—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è.</div>
            {% elif 'error=user_not_found' in request.url.query %}
            <div class="alert alert-error">–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–µ –Ω–∞–π–¥–µ–Ω.</div>
            {% elif 'error=cannot_delete_admin' in request.url.query %}
            <div class="alert alert-error">–ù–µ–ª—å–∑—è —É–¥–∞–ª–∏—Ç—å –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞.</div>
            {% elif 'error=user_deletion_failed' in request.url.query %}
            <div class="alert alert-error">–ù–µ —É–¥–∞–ª–æ—Å—å —É–¥–∞–ª–∏—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è.</div>
            {% elif 'error=secret_key_update_failed' in request.url.query %}
            <div class="alert alert-error">–ù–µ —É–¥–∞–ª–æ—Å—å –æ–±–Ω–æ–≤–∏—Ç—å SECRET_KEY.</div>
            {% elif 'success=user_created' in request.url.query %}
            <div class="alert alert-success">–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —É—Å–ø–µ—à–Ω–æ —Å–æ–∑–¥–∞–Ω.</div>
            {% elif 'success=user_deleted' in request.url.query %}
            <div class="alert alert-success">–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —É—Å–ø–µ—à–Ω–æ —É–¥–∞–ª–µ–Ω.</div>
            {% elif 'success=secret_key_updated' in request.url.query %}
            <div class="alert alert-success">SECRET_KEY —É—Å–ø–µ—à–Ω–æ –æ–±–Ω–æ–≤–ª–µ–Ω. –í—Å–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –±—É–¥—É—Ç –≤—ã—Ö–æ–¥–∏—Ç—å –∏–∑ —Å–∏—Å—Ç–µ–º—ã.</div>
            {% endif %}
        {% endif %}
        
        <!-- Users Management Section -->
        <div class="section">
            <h2 class="section-title">
                <span>üëÆ</span>
                –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏
            </h2>
            
            <div class="form-container">
                <h3 style="margin-bottom: 1rem;">‚ûï –î–æ–±–∞–≤–∏—Ç—å –Ω–æ–≤–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è</h3>
                <form method="post" action="/secret_scanner/admin/create-user">
                    <div class="form-row">
                        <div class="form-group">
                            <label for="username">–ò–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è</label>
                            <input type="text" id="username" name="username" required 
                                   pattern="[a-zA-Z0-9._-]+" 
                                   title="–î–æ–ø—É—Å—Ç–∏–º—ã —Ç–æ–ª—å–∫–æ –±—É–∫–≤—ã, —Ü–∏—Ñ—Ä—ã, —Ç–æ—á–∫–∏, –ø–æ–¥—á–µ—Ä–∫–∏–≤–∞–Ω–∏—è –∏ –¥–µ—Ñ–∏—Å—ã">
                        </div>
                        <div class="form-group">
                            <label for="password">–ü–∞—Ä–æ–ª—å</label>
                            <input type="password" id="password" name="password" required minlength="6">
                        </div>
                    </div>
                    <div class="form-actions">
                        <button type="submit" class="btn btn-success">–°–æ–∑–¥–∞—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è</button>
                    </div>
                </form>
            </div>
            
            <div style="margin-top: 2rem;">
                <h3 style="margin-bottom: 1rem;">üìã –°–ø–∏—Å–æ–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π</h3>
                <div class="loading" id="usersLoading">–ó–∞–≥—Ä—É–∑–∫–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π...</div>
                <table class="users-table" id="usersTable">
                    <thead>
                        <tr>
                            <th>–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å</th>
                            <th>–î–∞—Ç–∞ —Å–æ–∑–¥–∞–Ω–∏—è</th>
                            <th>–ó–∞–ø—É—â–µ–Ω–æ —Å–∫–∞–Ω–æ–≤</th>
                            <th>–°–æ–∑–¥–∞–Ω–æ –ø—Ä–æ–µ–∫—Ç–æ–≤</th>
                            <th>–î–µ–π—Å—Ç–≤–∏—è</th>
                        </tr>
                    </thead>
                    <tbody id="usersTableBody">
                        <!-- Users will be loaded here -->
                    </tbody>
                </table>
                
                <!-- Pagination -->
                <div id="pagination" style="display: none; margin-top: 1rem; text-align: center;">
                    <div style="display: flex; justify-content: center; align-items: center; gap: 0.5rem;">
                        <button type="button" class="btn btn-primary" id="prevPage" onclick="changePage(-1)" style="padding: 0.5rem 1rem;">
                            ‚Üê –ü—Ä–µ–¥—ã–¥—É—â–∞—è
                        </button>
                        <span id="pageInfo" style="padding: 0 1rem; font-weight: 600;"></span>
                        <button type="button" class="btn btn-primary" id="nextPage" onclick="changePage(1)" style="padding: 0.5rem 1rem;">
                            –°–ª–µ–¥—É—é—â–∞—è ‚Üí
                        </button>
                    </div>
                    <div id="totalInfo" style="margin-top: 0.5rem; color: #666; font-size: 0.9rem;"></div>
                </div>
            </div>
        </div>
        
        <!-- Secret Key Management Section -->
        <div class="section">
            <h2 class="section-title">
                <span>üîë</span>
                –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ SECRET_KEY
            </h2>
            
            <div>
                <h3 style="margin-bottom: 1rem;">üîê –¢–µ–∫—É—â–∏–π SECRET_KEY</h3>
                <div class="current-key">
                    {{ current_secret_key }}
                </div>
                <p style="color: #666; font-size: 0.9rem; margin-bottom: 2rem;">
                    –ü–æ–∫–∞–∑–∞–Ω—ã —Ç–æ–ª—å–∫–æ –ø–µ—Ä–≤—ã–µ 8 —Å–∏–º–≤–æ–ª–æ–≤ –¥–ª—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
                </p>
            </div>
            
            <div class="form-container">
                <h3 style="margin-bottom: 1rem;">üîÑ –û–±–Ω–æ–≤–∏—Ç—å SECRET_KEY</h3>
                <form method="post" action="/secret_scanner/admin/update-secret-key" 
                      onsubmit="return confirm('–í—ã —É–≤–µ—Ä–µ–Ω—ã? –í—Å–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –±—É–¥—É—Ç –≤—ã—Ö–æ–¥–∏—Ç—å –∏–∑ —Å–∏—Å—Ç–µ–º—ã –∏ –ø–æ—Ç—Ä–µ–±—É–µ—Ç—Å—è –ø–æ–≤—Ç–æ—Ä–Ω–∞—è –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è.')">
                    <div class="form-group">
                        <label for="secret_key">–ù–æ–≤—ã–π SECRET_KEY (–æ—Å—Ç–∞–≤—å—Ç–µ –ø—É—Å—Ç—ã–º –¥–ª—è –∞–≤—Ç–æ–≥–µ–Ω–µ—Ä–∞—Ü–∏–∏)</label>
                        <input type="text" id="secret_key" name="secret_key" 
                               placeholder="–ë—É–¥–µ—Ç —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏, –µ—Å–ª–∏ –æ—Å—Ç–∞–≤–∏—Ç—å –ø—É—Å—Ç—ã–º">
                        <div class="warning-text">
                            ‚ö†Ô∏è –í–Ω–∏–º–∞–Ω–∏–µ: –ò–∑–º–µ–Ω–µ–Ω–∏–µ SECRET_KEY –ø—Ä–∏–≤–µ–¥–µ—Ç –∫ –≤—ã—Ö–æ–¥—É –≤—Å–µ—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –∏–∑ —Å–∏—Å—Ç–µ–º—ã
                        </div>
                    </div>
                    <div class="form-actions">
                        <button type="submit" class="btn btn-warning">–û–±–Ω–æ–≤–∏—Ç—å SECRET_KEY</button>
                    </div>
                </form>
            </div>
        </div>

        <div class="section">
            <h2 class="section-title">
                <span>üìÑ</span>
                –≠–∫—Å–ø–æ—Ä—Ç —Å–µ–∫—Ä–µ—Ç–æ–≤
            </h2>
            
            <div class="form-container">
                <h3 style="margin-bottom: 1rem;">üì• –í—ã–≥—Ä—É–∑–∏—Ç—å —Å–µ–∫—Ä–µ—Ç—ã</h3>
                <form id="exportForm">
                    <div class="form-group">
                        <label for="status_filter">–¢–∏–ø —Å–µ–∫—Ä–µ—Ç–æ–≤ –¥–ª—è –≤—ã–≥—Ä—É–∑–∫–∏</label>
                        <select id="status_filter" name="status_filter" style="width: 100%; padding: 0.75rem; border: 2px solid #e1e5e9; border-radius: 8px; font-size: 1rem;">
                            <option value="all">–í—Å–µ —Å–µ–∫—Ä–µ—Ç—ã</option>
                            <option value="confirmed">–ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–Ω—ã–µ</option>
                            <option value="refuted">–û–ø—Ä–æ–≤–µ—Ä–≥–Ω—É—Ç—ã–µ</option>
                        </select>
                    </div>
                    <div class="form-actions">
                        <button type="submit" class="btn btn-primary" id="exportBtn">
                            <span>üìÑ</span>
                            –ù–∞—á–∞—Ç—å —ç–∫—Å–ø–æ—Ä—Ç
                        </button>
                    </div>
                </form>
            </div>
            
            <!-- Export Progress -->
            <div id="exportProgress" style="display: none; margin-top: 1rem;">
                <div style="background: #f8f9fa; border-radius: 8px; padding: 1.5rem;">
                    <div style="display: flex; align-items: center; gap: 0.5rem; margin-bottom: 1rem;">
                        <div class="spinner" style="width: 20px; height: 20px; border: 2px solid #e1e5e9; border-top: 2px solid #28a745; border-radius: 50%; animation: spin 1s linear infinite;"></div>
                        <div class="checkmark" style="display: none; width: 20px; height: 20px; font-size: 20px; color: #28a745;">‚úÖ</div>
                        <span style="font-weight: 600;">–ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ —Ñ–∞–π–ª–∞...</span>
                    </div>
                    <div id="exportMessage" style="color: #666; margin-bottom: 1rem;">–ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è...</div>
                    <div id="downloadSection" style="display: none;">
                        <button type="button" class="btn btn-success" id="downloadBtn">
                            <span>‚¨áÔ∏è</span>
                            –°–∫–∞—á–∞—Ç—å —Ñ–∞–π–ª
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <script src="/static/js/admin.js"></script>
</body>
</html>